version: "3.7"

# networks:
#   web:
#     external: true

services:
  web_game_class:
    build: ../frontend
    container_name: web_game_class
    ports:
      - "8029:8029"
    depends_on:
      - web_game_class_api
    restart: always
    # labels:
    #   - "traefik.enable=true"
    #   - "traefik.http.routers.webclass.rule=Host(`webclass.erikna.com`)"
    #   - "traefik.http.routers.webclass.entrypoints=web, websecure"
    #   - "traefik.http.routers.webclass.tls=true"
    #   - "traefik.http.routers.webclass.tls.certresolver=production"
    # networks:
    #   - web
  web_game_class_api:
    build: .
    ports:
      - "8030:8030"
    container_name: web_game_class_api
    depends_on:
      - redis_web_class_api
    restart: unless-stopped
  redis_web_class_api:
    image: redis
    container_name: redis_web_class_api
    command: redis-server --port 6020 --requirepass Utc30rgaq*
    environment:
      - REDIS_DISABLE_COMMANDS=FLUSHDB,FLUSHALL
    restart: always
    volumes:
      - game_redis_data:/data

volumes:
  game_redis_data:
